/**
 * Copyright (c) 2016 - 2020 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';
const MANIFEST = require('./manifest');
const Log = require('./lib/logger');
const Util = require('./lib/util');

const Transport = require('./lib/transport');

module.exports.init = function (logger, ecosystemInterface, manifestUpdates) {

    Log.Logger = logger;
    Log.Logger.INFO('Ecosystem module init');
    try {
        Util.updateManifest(MANIFEST, manifestUpdates, logger);
    }
    catch (e) {
        //$lab:coverage:off$
        Log.Logger.ERROR(e);
        //$lab:coverage:on$
    }

    require('./lib/interfaces').ecosystemInterface = ecosystemInterface;
    if (MANIFEST.transport.enabled === true) {
        Transport.enable(ecosystemInterface);
    }
};

module.exports.trace = require('./lib/tracing').trace;

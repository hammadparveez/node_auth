/**
 * Copyright (c) 2016 - 2020 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';

const INTERFACES = require('../../../../enums').INTERFACES;
const kIsBodyParser = require('../common').kIsBodyParser;

module.exports = function () {
    // Do nothing on module loading event - instrumentation happens through enable
};

module.exports.enable = function (ecoSystemInterface) {

    const instrumentation = ecoSystemInterface.getInterface(INTERFACES.INSTRUMENTATION);

    instrumentation.setWrapCallback('koa-body', (mod) => {

        return function wrappedFactory() {

            const middleware = mod.apply(this, arguments);

            middleware[kIsBodyParser] = true;

            return middleware;
        };
    });
};

